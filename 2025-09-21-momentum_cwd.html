<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>2025-09-21-momentum_cwd</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="post.css" />
  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<p><a href="run:2025-09-21-momentum_cwd.tex">September 21</a></p>
<h1 id="momentum-cautious-wd">Momentum + Cautious WD</h1>
<p><span class="math display">\[\begin{aligned}
    \dot x = - m - \mathbb{I}(mx\geq 0) x \\
    \dot m = \nabla f(x) - m.
\end{aligned}\]</span> <span class="math display">\[H(x, m) = f(x) +
\frac{1}{2} m^2 + (mx)_+\]</span></p>
<p>Let us use <span class="math inline">\(s \in[0,1]\)</span> to denote
the subgradient of <span class="math inline">\((mx)_+\)</span> within
<span class="math inline">\(H\)</span>. Let <span
class="math inline">\(p \in[0,1]\)</span> be the Flippiov variable of
<span class="math inline">\(\mathbb{I}(mx \geq 0)\)</span> inside the
velocity field. Note that <span class="math inline">\(s\)</span> and
<span class="math inline">\(p\)</span> are different. We need to keep
track of it in the derivation. <span
class="math display">\[\begin{aligned}
\dot H(s,p) &amp;  =  g \dot x + m \dot m + s (m \dot x + x \dot m) \\
&amp; = -g (m + p x) + m(g - m) + s (-m (m + p x) + x (g - m) )\\
&amp; = - p x g - m^2 + s (- m^2 + xg - (1+p)xm)
%(g + sm) \dot x + (m + s x) \dot m
\end{aligned}\]</span></p>
<p>If <span class="math inline">\(\alpha\)</span> belongs to <span
class="math inline">\(\dot H\)</span>, we want that for each <span
class="math inline">\(s\)</span>, there exists <span
class="math inline">\(p\)</span>, such that <span
class="math display">\[- p x g - m^2 + s (- m^2 + xg - (1+p)xm) =
-\alpha.\]</span> So we have <span class="math display">\[p (-xg - s x m
) - m^2 + s (-m^2 + xg - xm) = \alpha.\]</span> <span
class="math display">\[p = \frac{\alpha -(1+s) m^2 + s (xg - xm)}{xg
+  s xm}.\]</span> At the non-smooth point, we have <span
class="math inline">\(xm =0\)</span>, and it gives <span
class="math display">\[p = \frac{\alpha -(1+s) m^2 + s
(xg)}{xg}.\]</span> So <span class="math inline">\(p\)</span> is in
range of <span class="math display">\[\frac{\alpha - 2m^2 + xg}{xg},
~~~~
\frac{\alpha - m^2 }{xg}.\]</span> If <span class="math inline">\(xg
&gt;0\)</span>, we have <span class="math display">\[m^2 \leq \alpha
\leq m^2 + xg\]</span> <span class="math display">\[\alpha \leq 2m^2
\leq \alpha + xg\]</span> So <span class="math display">\[2m^2  - xg
\leq \alpha \leq 2 m^2\]</span></p>
<p><span class="math display">\[\cap_{s} \cup_{p} \dot H(s,
p).\]</span></p>
<p>For know the flippov system, the set valued Lie-derivation is defined
as: <span class="math display">\[\mathcal L_v H  =   
\{\alpha \colon \exists p, ~~~ s.t. ~~~ \dot H(s,p) = \alpha ~~~\forall
s \in \partial H \}.\]</span> So we want to find the <span
class="math inline">\(p\)</span> such that the <span
class="math inline">\(\dot H(s,p)\)</span> is independent with the
choice of <span class="math inline">\(s\)</span>.</p>
<p>So to make it independent on <span class="math inline">\(s\)</span>,
we want <span class="math display">\[-m^2 + xg -(1+p)xm  = 0.\]</span>
This gives <span class="math display">\[\begin{aligned}
\dot H
&amp; = -p(m^2 + (1+p) xm)- m^2 \\
&amp; = -(1+p)m^2 - p(1+p) xm.
\end{aligned}\]</span></p>
<p>If <span class="math inline">\(xm &lt;0\)</span>, we have <span
class="math inline">\(p=0\)</span>, and hence <span
class="math inline">\(\dot H = - m^2\)</span>. Invariant set is <span
class="math inline">\(\{xm &lt; 0, ~~ m=0\}\)</span>.</p>
<p>If <span class="math inline">\(xm &gt;0\)</span>, we have <span
class="math inline">\(p = 1\)</span>, and hence, <span
class="math inline">\(\dot H = -(2 m^2 + 2 (xm)_+)\)</span>. Invariant
set is <span class="math inline">\(\{xm=0, ~~ m=0\}.\)</span></p>
<p>If <span class="math inline">\(xm=0\)</span>, we have <span
class="math inline">\(\dot H = -(1+p) m^2\)</span>. Invariant set is
<span class="math inline">\(\{xm=0, m = 0\}\)</span>.</p>
<p>Hence, the invariant set is included in <span
class="math display">\[\{xm \leq 0, ~~ m = 0\}.\]</span></p>
<p>But since <span class="math inline">\(m=0\)</span>, we have <span
class="math inline">\(xm\leq 0\)</span> anyway.</p>
<h1 id="general-fillipov-from-scratch">General Fillipov From
Scratch</h1>
<div class="ctheorem">
<p>Assume we have non-smooth function <span
class="math inline">\(V(x)\)</span> with clark generalized gradient, and
let <span class="math inline">\(d\)</span> be an update direction. We
have</p>
</div>
<div class="cproof">
<p><span class="math display">\[\begin{aligned}
\lim_{\epsilon \to 0^+}\frac{V(x + \epsilon d) - V(x)}{\epsilon}
= ...
\end{aligned}\]</span></p>
</div>
<div class="thm">
<p><strong>Theorem 1</strong> (Great Theorem). <em>Yes, it is.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Yes. ◻</p>
</div>
<div class="theorem">
<p><strong>Theorem 2</strong> (Great Theorem). <em>This is the
second.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is the best. ◻</p>
</div>
</body>
</html>
