\ProvidesPackage{diary_ctheorems}
%%%%%%%%% RESEARCH DIARY - COLORED THEOREM ENVIRONMENTS %%%%%%%%%%%%
%% Beautiful colored theorem boxes and enhanced theorem environments
%% Provides colored alternatives to the basic theorems in diary_base.sty
%% Load this AFTER diary_base.sty for enhanced visual theorem environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter

%% REQUIRED PACKAGES (if not already loaded)
\@ifpackageloaded{thmtools}{}{\usepackage{thmtools}}
\@ifpackageloaded{mdframed}{}{\PassOptionsToPackage{framemethod=TikZ}{mdframed}\usepackage{mdframed}}

\theoremstyle{definition}

%% MASTER THEOREM STYLE FUNCTION
%% Creates consistent colored theorem boxes
\newcommand{\definecolorbox}[2]{%
  \expandafter\declaretheoremstyle\expandafter[%
    headfont=\bfseries\sffamily\color{#1!70!black}, 
    bodyfont=\normalfont,
    mdframed={%
      linewidth=2pt,
      rightline=false, 
      topline=false, 
      bottomline=false,
      linecolor=#1, 
      backgroundcolor=#1!5,
    }
  ]{#2}%
}

%% DEFINE COLOR SCHEMES FOR DIFFERENT THEOREM TYPES
\definecolorbox{ForestGreen}{thmgreenbox}      % Definitions, notes, remarks
\definecolorbox{NavyBlue}{thmbluebox}          % Examples, explanations
\definecolorbox{RawSienna}{thmredbox}          % Theorems, lemmas, propositions
\definecolorbox{LightPink!75!white}{thmpastelpinkbox}
\definecolorbox{Thistle!80!white}{thmpastelvioletbox}
\definecolorbox{Purple!75!white}{thmpurplebox}
\definecolorbox{Goldenrod!80!black}{thmgoldbox}
\definecolorbox{orange}{thmorangebox}          % Background, notation

%% STYLED THEOREM ENVIRONMENTS
%% These provide beautiful colored alternatives to basic theorems

%% Green Box Environments (Definitions and Notes)
\@ifundefined{cdefinition}{
  \declaretheorem[style=thmgreenbox, name=Definition]{cdefinition}
}{}

\@ifundefined{cremark}{
  \declaretheorem[style=thmgreenbox, numbered=no, name=Remark]{cremark*}
  \declaretheorem[style=thmgreenbox, name=Remark]{cremark}
}{}

\@ifundefined{cnote}{
  \declaretheorem[style=thmgreenbox, numbered=no, name=Note]{cnote*}
  \declaretheorem[style=thmgreenbox, name=Note]{cnote}
}{}

%% Orange Box Environments (Background Information)
\declaretheorem[style=thmorangebox, name=Background]{background}
\declaretheorem[style=thmorangebox, numbered=no, name=Background]{background*}
\declaretheorem[style=thmorangebox, numbered=no, name=Notation]{notation*}
\declaretheorem[style=thmorangebox, name=Notation]{notation}

%% Blue Box Environments (Examples and Explanations)
\@ifundefined{cexample}{
  \declaretheorem[style=thmbluebox, numbered=no, name=Example]{cexample*}
  \declaretheorem[style=thmbluebox, name=Example]{cexample}
}{}

%% Red Box Environments (Main Results)
\@ifundefined{cproposition}{
  \declaretheorem[style=thmredbox, name=Proposition]{cproposition} 
}{}

\@ifundefined{ctheorem}{
  \declaretheorem[style=thmredbox, name=Theorem]{ctheorem}
}{}

\@ifundefined{clemma}{
  \declaretheorem[style=thmredbox, name=Lemma]{clemma}
}{}

\@ifundefined{ccorollary}{
  \declaretheorem[style=thmredbox, name=Corollary]{ccorollary}
}{}

%% NOTE: Standard theorem environments (theorem, lemma, etc.) remain unchanged
%% Use c-prefixed versions (ctheorem, clemma, etc.) for colored boxes

%% SPECIAL THEOREM ENVIRONMENTS (always available)
\newtheorem*{uovt}{UOVT}
\newtheorem*{previouslyseen}{As previously seen}
\newtheorem*{problem}{Problem}
\newtheorem*{observe}{Observe}
\newtheorem*{property}{Property}
\newtheorem*{intuition}{Intuition}

%% ENHANCED PROOF ENVIRONMENTS
%% Custom styled proof boxes

\declaretheoremstyle[
  headfont=\bfseries\sffamily\color{RawSienna!70!black}, 
  bodyfont=\normalfont,
  numbered=no,
  mdframed={
    linewidth=2pt,
    rightline=false, 
    topline=false, 
    bottomline=false,
    linecolor=RawSienna, 
    backgroundcolor=RawSienna!1,
  },
  qed=\qedsymbol
]{thmproofbox}

\declaretheoremstyle[
  headfont=\bfseries\sffamily\color{NavyBlue!70!black}, 
  bodyfont=\normalfont,
  numbered=no,
  mdframed={
    linewidth=2pt,
    rightline=false, 
    topline=false, 
    bottomline=false,
    linecolor=NavyBlue, 
    backgroundcolor=NavyBlue!1,
  }
]{thmexplanationbox}

%% Colored proof environment (cproof) - standard proof remains unchanged
\declaretheorem[style=thmproofbox, name=Proof]{cproof}

%% Explanation environment for detailed explanations
\declaretheorem[style=thmexplanationbox, name=Explanation]{tmpexplanation}
\newenvironment{explanation}[1][]{\vspace{-10pt}\begin{tmpexplanation}}{\end{tmpexplanation}}

%% FLEXIBLE COLORED BOX ENVIRONMENT
%% Usage: \begin{cbox}[color][title] ... \end{cbox}
%% Examples: 
%%   \begin{cbox} ... \end{cbox}                    % Default blue box
%%   \begin{cbox}[red] ... \end{cbox}               % Red box, no title
%%   \begin{cbox}[green][Important Note] ... \end{cbox}  % Green box with title

\NewDocumentEnvironment{cbox}{O{blue} o}{
  \IfValueTF{#2}{%
    \begin{mdframed}[
      linewidth=2pt,
      linecolor=#1,
      backgroundcolor=#1!5,
      rightline=false,
      topline=false,
      bottomline=false,
      innertopmargin=10pt,
      innerbottommargin=10pt,
      innerleftmargin=10pt,
      innerrightmargin=10pt,
      frametitle={\normalfont\sffamily\bfseries\color{#1!70!black} #2},
      frametitleaboveskip=5pt,
      frametitlealignment=\raggedright
    ]%
  }{%
    \begin{mdframed}[
      linewidth=2pt,
      linecolor=#1,
      backgroundcolor=#1!5,
      rightline=false,
      topline=false,
      bottomline=false,
      innertopmargin=10pt,
      innerbottommargin=10pt,
      innerleftmargin=10pt,
      innerrightmargin=10pt
    ]%
  }%
}{
  \end{mdframed}
}

\makeatother

%% USAGE NOTES:
%% - For basic theorems: Use environments from diary_base.sty (thm, lem, cor, etc.) or standard (theorem, lemma, etc.)
%% - For colored theorems: Use c* environments (ctheorem, clemma, ccorollary, cdefinition, etc.)
%% - For proofs: Use standard \begin{proof} or colored \begin{cproof}
%% - For custom boxes: Use cbox environment with optional color and title
%% - All environments are designed to work together without conflicts
