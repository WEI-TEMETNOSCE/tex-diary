<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <title>2025 09 21 Momentum_Cwd</title>
    <link rel="stylesheet" href="post.css" />
    
    <!-- MathJax Configuration -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true,
            processEnvironments: true,
            macros: {
                "coloneq": "\\mathrel{\\mathop:}=",
                "RR": "\\mathbb{R}",
                "CC": "\\mathbb{C}",
                "NN": "\\mathbb{N}",
                "PP": "\\mathbb{P}",
                "E": "\\mathbb{E}",
                "D": "\\mathbb{D}",
                "P": "\\mathcal{P}",
                "H": "\\mathcal{H}",
                "X": "\\mathcal{X}",
                "B": "\\mathcal{B}",
                "F": "\\mathcal{F}",
                "M": "\\mathbb{M}",
                "var": "\\mathrm{var}",
                "Var": "\\mathrm{Var}",
                "cov": "\\mathrm{cov}",
                "Cov": "\\mathrm{Cov}",
                "corr": "\\mathrm{corr}",
                "Corr": "\\mathrm{Corr}",
                "pr": "\\mathrm{Pr}",
                "prob": "\\mathrm{Pr}",
                "normal": "\\mathcal{N}",
                "MSE": "\\mathrm{MSE}",
                "KL": "\\mathrm{KL}",
                "V": "\\mathbf",
                "vx": "\\boldsymbol{x}",
                "trace": "\\mathrm{trace}",
                "diag": "\\mathrm{diag}",
                "tt": "^\\top",
                "df": "\\mathrm{d}",
                "d": "\\mathrm{d}",
                "dt": "\\mathrm{d}t",
                "dW": "\\mathrm{d}W",
                "dno": "\\mathrm{d}",
                "dd": "\\nabla",
                "tdd": "\\tilde{\\nabla}",
                "ddt": "\\frac{\\mathrm{d}}{\\mathrm{d} t}",
                "div": "\\nabla\\cdot",
                "ind": "\\mathbb{I}",
                "sign": "\\mathrm{sign}",
                "cd": "\\mid",
                "la": "\\langle",
                "ra": "\\rangle",
                "sumstein": "\\mathcal{T}",
                "stein": "\\mathcal{A}",
                "score": "\\boldsymbol{\g<1>}",
                "ff": "\\boldsymbol{\g<1>}",
                "eng": "E",
                "hattheta": "\\hat{\\theta}",
                "cc": "\\theta",
                "kernel": "\\mathbf{k}",
                "datai": "^{(i)}",
                "defeq": "\\mathrel{\\aban@defeq}",
                "workingDate": "\\textsc{<YEAR> $|$ <MONTH_NAME> $|$ <DAY>}",
                "userName": "<AUTHOR>",
                "institution": "<INSTITUTION>",
                "nablat": "\\frac{\\mathrm{d}}{\\mathrm{d} t}",
                "diaryTitle": "<DIARY_TITLE>",
                "myb": ["\\mbox{\\boldmath$#1$}", 1],
                "eqnref": ["Eqn.~\\eqref{#1}", 1],
                "figref": ["Fig.~\\ref{#1}", 1],
                "here": ["\\url{#1}", 1],
                "Qiang": ["\\textcolor{red}{#1}\\\\", 1],
                "qiang": ["\\textcolor{red}{#1}", 1],
                "Todo": ["\\textcolor{red}{TODO: #1}\\\\", 1],
                "todo": ["\\textcolor{gray}{TODO: #1}", 1],
                "remark": ["\\paragraph{Remark}#1", 1],
                "red": ["\\textcolor{red}{#1}", 1],
                "med": ["\\textcolor{magenta}{#1}", 1],
                "blue": ["\\textcolor{blue}{#1}", 1],
                "gray": ["\\textcolor{gray}{#1}", 1],
                "green": ["\\textcolor{green}{#1}", 1],
                "myempty": ["", 1],
                "vv": ["\\boldsymbol{#1}", 1],
                "neib": ["\\partial{#1}", 1],
                "set": ["\\mathcal{#1}", 1],
                "funcset": ["\\mathcal{#1}", 1],
                "opt": ["\\mathcal{#1}", 1],
                "greedy": ["\\mathrm{Greedy}\\{#1\\}", 1],
                "clickhere": ["\\href{run:#1}{Click here}", 1],
                "e": ["\\mathbb{E}\\left[#1\\right]", 1],
                "myf": ["\\frac{\\displaystyle #1}{\\displaystyle #2}", 2],
                "myp": ["\\frac{\\displaystyle \\partial #1}{\\displaystyle \\partial  #2}", 2],
                "f": ["\\frac{#1}{#2}", 2],
                "definecolorbox": ["\\expandafter\\declaretheoremstyle\\expandafter[headfont=\\bfseries\\sffamily\\color{#1!70!black}, 
    bodyfont=\\normalfont,
    mdframed={linewidth=2pt,
      rightline=false, 
      topline=false, 
      bottomline=false,
      linecolor=#1, 
      backgroundcolor=#1!5,
    }
  ]{#2}", 2]
            }
        },
        options: {
            ignoreHtmlClass: "tex2jax_ignore",
            processHtmlClass: "tex2jax_process"
        }
    };
    </script>
    <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body>
    <p><a href="run:2025-09-21-momentum_cwd.tex">September 21</a></p>
<h1 id="momentum-cautious-wd">Momentum + Cautious WD</h1>
<p><span class="math display">\[\begin{aligned}
    \dot x = - m - \mathbb{I}(mx\geq 0) x \\
    \dot m = \nabla f(x) - m.
\end{aligned}\]</span> <span class="math display">\[H(x, m) = f(x) +
\frac{1}{2} m^2 + (mx)_+\]</span></p>
<p>Let us use <span class="math inline">\(s \in[0,1]\)</span> to denote
the subgradient of <span class="math inline">\((mx)_+\)</span> within
<span class="math inline">\(H\)</span>. Let <span
class="math inline">\(p \in[0,1]\)</span> be the Flippiov variable of
<span class="math inline">\(\mathbb{I}(mx \geq 0)\)</span> inside the velocity
field. Note that <span class="math inline">\(s\)</span> and <span
class="math inline">\(p\)</span> are different. We need to keep track of
it in the derivation. <span class="math display">\[\begin{aligned}
\dot H(s,p) &amp;  =  g \dot x + m \dot m + s (m \dot x + x \dot m) \\
&amp; = -g (m + p x) + m(g - m) + s (-m (m + p x) + x (g - m) )\\
&amp; = - p x g - m^2 + s (- m^2 + xg - (1+p)xm)
%(g + sm) \dot x + (m + s x) \dot m
\end{aligned}\]</span></p>
<p>If <span class="math inline">\(\alpha\)</span> belongs to <span
class="math inline">\(\dot H\)</span>, we want that for each <span
class="math inline">\(s\)</span>, there exists <span
class="math inline">\(p\)</span>, such that <span
class="math display">\[- p x g - m^2 + s (- m^2 + xg - (1+p)xm) =
-\alpha.\]</span> So we have <span class="math display">\[p (-xg - s x m
) - m^2 + s (-m^2 + xg - xm) = \alpha.\]</span> <span
class="math display">\[p = \frac{\alpha -(1+s) m^2 + s (xg - xm)}{xg
+  s xm}.\]</span> At the non-smooth point, we have <span
class="math inline">\(xm =0\)</span>, and it gives <span
class="math display">\[p = \frac{\alpha -(1+s) m^2 + s
(xg)}{xg}.\]</span> So <span class="math inline">\(p\)</span> is in
range of <span class="math display">\[\frac{\alpha - 2m^2 + xg}{xg},
~~~~
\frac{\alpha - m^2 }{xg}.\]</span> If <span class="math inline">\(xg
&gt;0\)</span>, we have <span class="math display">\[m^2 \leq \alpha
\leq m^2 + xg\]</span> <span class="math display">\[\alpha \leq 2m^2
\leq \alpha + xg\]</span> So <span class="math display">\[2m^2  - xg
\leq \alpha \leq 2 m^2\]</span></p>
<p><span class="math display">\[\cap_{s} \cup_{p} \dot H(s,
p).\]</span></p>
<p>For know the flippov system, the set valued Lie-derivation is defined
as: <span class="math display">\[\mathcal L_v H  =   
\{\alpha \colon \exists p, ~~~ s.t. ~~~ \dot H(s,p) = \alpha ~~~\forall
s \in \partial H \}.\]</span> So we want to find the <span
class="math inline">\(p\)</span> such that the <span
class="math inline">\(\dot H(s,p)\)</span> is independent with the
choice of <span class="math inline">\(s\)</span>.</p>
<p>So to make it independent on <span class="math inline">\(s\)</span>,
we want <span class="math display">\[-m^2 + xg -(1+p)xm  = 0.\]</span>
This gives <span class="math display">\[\begin{aligned}
\dot H
&amp; = -p(m^2 + (1+p) xm)- m^2 \\
&amp; = -(1+p)m^2 - p(1+p) xm.
\end{aligned}\]</span></p>
<p>If <span class="math inline">\(xm &lt;0\)</span>, we have <span
class="math inline">\(p=0\)</span>, and hence <span
class="math inline">\(\dot H = - m^2\)</span>. Invariant set is <span
class="math inline">\(\{xm &lt; 0, ~~ m=0\}\)</span>.</p>
<p>If <span class="math inline">\(xm &gt;0\)</span>, we have <span
class="math inline">\(p = 1\)</span>, and hence, <span
class="math inline">\(\dot H = -(2 m^2 + 2 (xm)_+)\)</span>. Invariant
set is <span class="math inline">\(\{xm=0, ~~ m=0\}.\)</span></p>
<p>If <span class="math inline">\(xm=0\)</span>, we have <span
class="math inline">\(\dot H = -(1+p) m^2\)</span>. Invariant set is
<span class="math inline">\(\{xm=0, m = 0\}\)</span>.</p>
<p>Hence, the invariant set is included in <span
class="math display">\[\{xm \leq 0, ~~ m = 0\}.\]</span></p>
<p>But since <span class="math inline">\(m=0\)</span>, we have <span
class="math inline">\(xm\leq 0\)</span> anyway.</p>
<h1 id="general-fillipov-from-scratch">General Fillipov From
Scratch</h1>
<div class="ctheorem">
<p>Assume we have non-smooth function <span
class="math inline">\(V(x)\)</span> with clark generalized gradient, and
let <span class="math inline">\(d\)</span> be an update direction. We
have</p>
</div>
<div class="cproof">
<p><span class="math display">\[\begin{aligned}
\lim_{\epsilon \to 0^+}\frac{V(x + \epsilon d) - V(x)}{\epsilon}
= ...
\end{aligned}\]</span></p>
</div>
<div class="thm">
<p>Yes, it is.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Yes. ◻</p>
</div>
<div class="theorem">
<p>This is the second.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This is the best. ◻</p>
</div>

</body>
</html>
